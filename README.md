Sorry about the messy codes, I will clean them soon.
